#!/bin/bash

echo "üåê EC2 Public IP Assignment Helper"
echo "=================================="
echo ""

INSTANCE_ID="i-0758d679383783e48"

echo "Instance ID: $INSTANCE_ID"
echo "Current status: No public IP assigned"
echo ""

echo "üéØ Option 1: Allocate and Associate Elastic IP (Recommended)"
echo "------------------------------------------------------------"
echo "This gives you a permanent public IP that won't change when you restart the instance."
echo ""
echo "AWS CLI commands:"
echo "# 1. Allocate an Elastic IP"
echo "aws ec2 allocate-address --domain vpc"
echo ""
echo "# 2. Associate it with your instance (replace ALLOCATION_ID with the one from step 1)"
echo "aws ec2 associate-address --instance-id $INSTANCE_ID --allocation-id eipalloc-xxxxxxxxx"
echo ""

echo "üéØ Option 2: Enable Auto-assign Public IP (Simpler)"
echo "---------------------------------------------------"
echo "This assigns a new public IP each time you start the instance."
echo ""
echo "Manual steps:"
echo "1. Go to AWS Console ‚Üí EC2 ‚Üí Instances"
echo "2. Select instance: $INSTANCE_ID"
echo "3. Actions ‚Üí Networking ‚Üí Modify auto-assign public IP"
echo "4. Check 'Enable auto-assign public IPv4 address'"
echo "5. Save"
echo "6. Stop and start the instance (reboot won't work)"
echo ""

echo "üéØ Option 3: Use AWS Systems Manager (No public IP needed)"
echo "----------------------------------------------------------"
echo "Connect without a public IP using AWS Systems Manager."
echo ""
echo "Requirements:"
echo "1. Install Session Manager plugin:"
echo "   curl 'https://s3.amazonaws.com/session-manager-downloads/plugin/latest/mac/sessionmanager-bundle.zip' -o 'sessionmanager-bundle.zip'"
echo "   unzip sessionmanager-bundle.zip"
echo "   sudo ./sessionmanager-bundle/install -i /usr/local/sessionmanagerplugin -b /usr/local/bin/session-manager-plugin"
echo ""
echo "2. Connect via SSM:"
echo "   aws ssm start-session --target $INSTANCE_ID"
echo ""

echo "üîß Check current instance status:"
echo "aws ec2 describe-instances --instance-ids $INSTANCE_ID --query 'Reservations[0].Instances[0].{State:State.Name,PublicIP:PublicIpAddress,PrivateIP:PrivateIpAddress}'"
echo ""

echo "üí° Recommended: Use Option 1 (Elastic IP) for a permanent solution!"